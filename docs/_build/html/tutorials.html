

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Distributed Resource Management Application API &mdash; DRMAA Python 0.7.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="DRMAA Python 0.7.1 documentation" href="index.html" />
    <link rel="next" title="drmaa Package" href="drmaa.html" />
    <link rel="prev" title="Welcome to DRMAA Python’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="drmaa.html" title="drmaa Package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to DRMAA Python’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">DRMAA Python 0.7.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="distributed-resource-management-application-api">
<h1>Distributed Resource Management Application API<a class="headerlink" href="#distributed-resource-management-application-api" title="Permalink to this headline">¶</a></h1>
<p>This guide is a tutorial for getting started programming with DRMAA. It is
basically a one to one translation of the original in C for Grid Engine. It
assumes that you already know what DRMAA is and that you have drmaa-python
installed. If not, have a look at Installing. The following code segments are
also included in the repository.</p>
<div class="section" id="starting-and-stopping-a-session">
<h2>Starting and Stopping a Session<a class="headerlink" href="#starting-and-stopping-a-session" title="Permalink to this headline">¶</a></h2>
<p>The following code segments (example1.py and example1.1.py) shows the most basic
DRMAA python binding program.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">drmaa</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   <span class="sd">&quot;&quot;&quot;Create a drmaa session and exit&quot;&quot;&quot;</span>
   <span class="k">with</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&#39;A session was started successfully&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&#39;__main__&#39;</span><span class="p">:</span>
   <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>The first thing to notice is that every call to a DRMAA function will return an
error code. In this tutorial, we ignore all error codes.</p>
<p>Now let&#8217;s look at the functions being called. First, on line 7, we initialise a
Session object by calling DRMAA.Session(). The Session is automatically
initialized via initialize(), and it creates a session and starts an event
client listener thread. The session is used for organizing jobs submitted
through DRMAA, and the thread is used to receive updates from the queue master
about the state of jobs and the system in general. Once initialize() has been
called successfully, it is the responsibility of the calling application to also
call exit() before terminating. If an application does not call exit() before
terminating, session state may be left behind in the user&#8217;s home directory, and
the queue master may be left with a dead event client handle, which can decrease
queue master performance.</p>
<p>At the end of our program, on line 9, we call exit(). exit() cleans up the
session and stops the event client listener thread. Most other DRMAA functions
must be called before exit(). Some functions, like getContact(), can be called
after exit(), but these functions only provide general information. Any function
that does work, such as runJob() or wait() must be called before exit() is
called. If such a function is called after exit() is called, it will return an
error.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">drmaa</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Create a session, show that each session has an id,</span>
<span class="sd">    use session id to disconnect, then reconnect. Then exit&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">s</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;A session was started successfully&#39;</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">contact</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;session contact returns: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">response</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Exited from session&#39;</span><span class="p">)</span>

    <span class="n">s</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Session was restarted successfullly&#39;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>This example is very similar to Example 1. The difference is that it uses the
Grid Engine feature of reconnectable sessions. The DRMAA concept of a session is
translated into a session tag in the Grid Engine job structure. That means that
every job knows to which session it belongs. With reconnectable sessions, it&#8217;s
possible to initialize the DRMAA library to a previous session, allowing the
library access to that session&#8217;s job list. The only limitation, though, is that
jobs which end between the calls to exit() and init() will be lost, as the
reconnecting session will no longer see these jobs, and so won&#8217;t know about
them.</p>
<p>Through line 9, this example is very similar to Example 1. On line 10, however,
we use the contact attribute to get the contact information for this session. On
line 12 we then exit the session. On line 15, we use the stored contact
information to reconnect to the previous session. Had we submitted jobs before
calling exit(), those jobs would now be available again for operations such as
wait() and synchronize(). Finally, on line 17 we exit the session a second time.</p>
</div>
<div class="section" id="running-a-job">
<h2>Running a Job<a class="headerlink" href="#running-a-job" title="Permalink to this headline">¶</a></h2>
<p>The following code segment (example2.py and example2.1.py) shows how to use the
DRMAA python binding to submit a job to Grid Engine. It submits a small shell
script (sleeper.sh) which takes two arguments:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="nb">echo</span> <span class="s2">&quot;Hello world, the answer is $1&quot;</span>
sleep 3s
<span class="nb">echo</span> <span class="s2">&quot;$2 Bye world!&quot;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">drmaa</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   <span class="sd">&quot;&quot;&quot;Submit a job.</span>
<span class="sd">   Note, need file called sleeper.sh in current directory.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">with</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
       <span class="k">print</span><span class="p">(</span><span class="s">&#39;Creating job template&#39;</span><span class="p">)</span>
       <span class="n">jt</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">createJobTemplate</span><span class="p">()</span>
       <span class="n">jt</span><span class="o">.</span><span class="n">remoteCommand</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s">&#39;sleeper.sh&#39;</span><span class="p">)</span>
       <span class="n">jt</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;42&#39;</span><span class="p">,</span> <span class="s">&#39;Simon says:&#39;</span><span class="p">]</span>
       <span class="n">jt</span><span class="o">.</span><span class="n">joinFiles</span><span class="o">=</span><span class="bp">True</span>

       <span class="n">jobid</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">runJob</span><span class="p">(</span><span class="n">jt</span><span class="p">)</span>
       <span class="k">print</span><span class="p">(</span><span class="s">&#39;Your job has been submitted with id </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">jobid</span><span class="p">)</span>

       <span class="k">print</span><span class="p">(</span><span class="s">&#39;Cleaning up&#39;</span><span class="p">)</span>
       <span class="n">s</span><span class="o">.</span><span class="n">deleteJobTemplate</span><span class="p">(</span><span class="n">jt</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&#39;__main__&#39;</span><span class="p">:</span>
   <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>The beginning and end of this program are the same as the previous one. What&#8217;s
different is in lines 13-23. On line 13 we ask DRMAA to allocate a job template
for us. A job template is a structure used to store information about a job to
be submitted. The same template can be reused for multiple calls to runJob() or
runBulkJob().</p>
<p>On line 14 we set the REMOTE_COMMAND attribute. This attribute tells DRMAA where
to find the program we want to run. Its value is the path to the executable. The
path be be either relative or absolute. If relative, it is relative to the WD
attribute, which if not set defaults to the user&#8217;s home directory. For more
information on DRMAA attributes, please see the attributes man page. Note that
for this program to work, the script &#8220;sleeper.sh&#8221; must be in the current
directory.</p>
<p>On line 15 we set the V_ARGV attribute. This attribute tells DRMAA what
arguments to pass to the executable. For more information on DRMAA attributes,
please see the attributes man page.</p>
<p>On line 18 we submit the job with runJob(). DRMAA will place the id assigned to
the job into the character array we passed to runJob(). The job is now running
as though submitted by qsub or bsub. At this point calling exit() and/or
terminating the program will have no effect on the job.</p>
<p>To clean things up, we delete the job template on line 22. This frees the memory
DRMAA set aside for the job template, but has no effect on submitted jobs.
Finally, on line 23, we call exit().</p>
<p>If instead of a single job we had wanted to submit an array job, we could have
replaced the else on line 18 and 19 with the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">jobid</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">runBulkJobs</span><span class="p">(</span><span class="n">jt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Your job has been submitted with id </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">jobid</span><span class="p">)</span>
</pre></div>
</div>
<p>This code segment submits an array job with 15 tasks numbered 1, 3, 5, 7, etc.
An important difference to note is that runBulkJobs() returns the job ids in an
array. On line 19, we print all the job ids.</p>
</div>
<div class="section" id="waiting-for-a-job">
<h2>Waiting for a Job<a class="headerlink" href="#waiting-for-a-job" title="Permalink to this headline">¶</a></h2>
<p>Now we&#8217;re going to extend our example to include waiting for a job to finish
(example3.py, example3.1.py and example3.2.py).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">drmaa</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Submit a job and wait for it to finish.</span>
<span class="sd">    Note, need file called sleeper.sh in home directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Creating job template&#39;</span><span class="p">)</span>
        <span class="n">jt</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">createJobTemplate</span><span class="p">()</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">remoteCommand</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s">&#39;sleeper.sh&#39;</span><span class="p">)</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;42&#39;</span><span class="p">,</span> <span class="s">&#39;Simon says:&#39;</span><span class="p">]</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">joinFiles</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">jobid</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">runJob</span><span class="p">(</span><span class="n">jt</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Your job has been submitted with id </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">jobid</span><span class="p">)</span>

        <span class="n">retval</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">jobid</span><span class="p">,</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="o">.</span><span class="n">TIMEOUT_WAIT_FOREVER</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Job: {0} finished with status {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">retval</span><span class="o">.</span><span class="n">jobId</span><span class="p">,</span> <span class="n">retval</span><span class="o">.</span><span class="n">hasExited</span><span class="p">))</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Cleaning up&#39;</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">deleteJobTemplate</span><span class="p">(</span><span class="n">jt</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>This example is very similar to Example 2 except for line 21. On line 21 we call
wait() to wait for the job to end. We have to give wait() both the id of the job
for which we want to wait and a place to write the id of the job for which we
actually waited because the job id we pass in could be JOB_IDS_SESSION_ANY, in
which case wait() must have a way of tell us which job is the one that made it
return. We also have to pass to wait() how long we are willing to wait for the
job to finish. This could be a number of seconds, or it could be either
TIMEOUT_WAIT_FOREVER or TIMEOUT_NO_WAIT. Lastly, we collect the exit status.
Assuming the wait worked, we query the job&#8217;s exit status on line 22.</p>
<p>An alternative to wait() when working with multiple jobs, such as jobs submitted
by runBulkJobs() or multiple calls to runJob() is synchronize(). synchronize()
waits for a set of jobs to finish. To use synchronize(), we could replace lines
18-22 with the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">joblist</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">runBulkJobs</span><span class="p">(</span><span class="n">jt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Your job has been submitted with id </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">joblist</span><span class="p">)</span>

<span class="n">s</span><span class="o">.</span><span class="n">synchronize</span><span class="p">(</span><span class="n">joblist</span><span class="p">,</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="o">.</span><span class="n">TIMEOUT_WAIT_FOREVER</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Line 18 now call runBulkJobs() so that we have several jobs for which to wait.
On line 21, instead of calling wait(), we call synchronize(). synchronize()
takes only three interesting parameters. The first is the list of ids for which
to wait. This list must be a NULL-terminated array of strings. If the special
id, JOB_IDS_SESSION_ALL, appears in the array, synchronize() will wait for all
jobs submitted via DRMAA during this session, i.e. since initialize() was
called. The second is how long to wait for all the jobs in the list to finish.
This is the same as the timeout parameter for wait(). The third is whether this
call to synchronize() should clean up after the job. After a job completes, it
leaves behind accounting information, such as exist status and usage, until
either wait() or synchronize() with dispose set to true is called. It is the
responsibility of the application to make sure one of these two functions is
called for every job. Not doing so creates a memory leak. Note that calling
synchronize() with dispose set to true flushes all accounting information for
all jobs in the list. If you want to use synchronize() and still recover the
accounting information, set dispose to false and call wait() for each job. To do
this in Example 3, we would replace lines 18&#8211;22 with the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">joblist</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">runBulkJobs</span><span class="p">(</span><span class="n">jt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Your job has been submitted with id </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">joblist</span><span class="p">)</span>

<span class="n">s</span><span class="o">.</span><span class="n">synchronize</span><span class="p">(</span><span class="n">joblist</span><span class="p">,</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="o">.</span><span class="n">TIMEOUT_WAIT_FOREVER</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">curjob</span> <span class="ow">in</span> <span class="n">joblist</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Collecting job &#39;</span> <span class="o">+</span> <span class="n">curjob</span><span class="p">)</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">curjob</span><span class="p">,</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="o">.</span><span class="n">TIMEOUT_WAIT_FOREVER</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Job: {0} finished with status {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">retval</span><span class="o">.</span><span class="n">jobId</span><span class="p">,</span>
                                                     <span class="n">retval</span><span class="o">.</span><span class="n">hasExited</span><span class="p">))</span>
</pre></div>
</div>
<p>What&#8217;s different is that on line 22 we set dispose to false, and then on lines
23-26 we wait once for each job, printing the exit status and usage information
as we did in Example 3.</p>
<p>We pass joblist to synchronise to wait for each job specifically. Otherwise, the
wait() could end up waiting for a job submitted after the call to synchronize().</p>
</div>
<div class="section" id="controlling-a-job">
<h2>Controlling a Job<a class="headerlink" href="#controlling-a-job" title="Permalink to this headline">¶</a></h2>
<p>Now let&#8217;s look at an example of how to control a job from DRMAA (example4.py):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">drmaa</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Submit a job, then kill it.</span>
<span class="sd">    Note, need file called sleeper.sh in home directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Creating job template&#39;</span><span class="p">)</span>
        <span class="n">jt</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">createJobTemplate</span><span class="p">()</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">remoteCommand</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s">&#39;sleeper.sh&#39;</span><span class="p">)</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;42&#39;</span><span class="p">,</span> <span class="s">&#39;Simon says:&#39;</span><span class="p">]</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">joinFiles</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">jobid</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">runJob</span><span class="p">(</span><span class="n">jt</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Your job has been submitted with id </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">jobid</span><span class="p">)</span>
        <span class="c"># options are: SUSPEND, RESUME, HOLD, RELEASE, TERMINATE</span>
        <span class="n">s</span><span class="o">.</span><span class="n">control</span><span class="p">(</span><span class="n">jobid</span><span class="p">,</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">JobControlAction</span><span class="o">.</span><span class="n">TERMINATE</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Cleaning up&#39;</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">deleteJobTemplate</span><span class="p">(</span><span class="n">jt</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>This example is very similar to Example 2 except for line 21. On line 21 we use
control() to delete the job we just submitted. Aside from deleting the job, we
could have also used control() to suspend, resume, hold, or release it. For more
information, see the control man page.</p>
<p>Note that control() can be used to control jobs not submitted through DRMAA. Any
valid SGE job id could be passed to control() as the id of the job to delete.</p>
</div>
<div class="section" id="getting-job-status">
<h2>Getting Job Status<a class="headerlink" href="#getting-job-status" title="Permalink to this headline">¶</a></h2>
<p>Here&#8217;s an example of using DRMAA to query the status of a job (example5.py):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">drmaa</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Submit a job, and check its progress.</span>
<span class="sd">    Note, need file called sleeper.sh in home directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Creating job template&#39;</span><span class="p">)</span>
        <span class="n">jt</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">createJobTemplate</span><span class="p">()</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">remoteCommand</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s">&#39;sleeper.sh&#39;</span><span class="p">)</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;42&#39;</span><span class="p">,</span> <span class="s">&#39;Simon says:&#39;</span><span class="p">]</span>
        <span class="n">jt</span><span class="o">.</span><span class="n">joinFiles</span><span class="o">=</span><span class="bp">True</span>

        <span class="n">jobid</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">runJob</span><span class="p">(</span><span class="n">jt</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Your job has been submitted with id </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">jobid</span><span class="p">)</span>

        <span class="c"># Who needs a case statement when you have dictionaries?</span>
        <span class="n">decodestatus</span> <span class="o">=</span> <span class="p">{</span><span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">UNDETERMINED</span><span class="p">:</span> <span class="s">&#39;process status cannot be determined&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">QUEUED_ACTIVE</span><span class="p">:</span> <span class="s">&#39;job is queued and active&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">SYSTEM_ON_HOLD</span><span class="p">:</span> <span class="s">&#39;job is queued and in system hold&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">USER_ON_HOLD</span><span class="p">:</span> <span class="s">&#39;job is queued and in user hold&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">USER_SYSTEM_ON_HOLD</span><span class="p">:</span> <span class="s">&#39;job is queued and in user and system hold&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">:</span> <span class="s">&#39;job is running&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">SYSTEM_SUSPENDED</span><span class="p">:</span> <span class="s">&#39;job is system suspended&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">USER_SUSPENDED</span><span class="p">:</span> <span class="s">&#39;job is user suspended&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">DONE</span><span class="p">:</span> <span class="s">&#39;job finished normally&#39;</span><span class="p">,</span>
                        <span class="n">drmaa</span><span class="o">.</span><span class="n">JobState</span><span class="o">.</span><span class="n">FAILED</span><span class="p">:</span> <span class="s">&#39;job finished, but failed&#39;</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Checking </span><span class="si">%s</span><span class="s"> of 10 times&#39;</span> <span class="o">%</span> <span class="n">ix</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">decodestatus</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">jobStatus</span><span class="p">(</span><span class="n">jobid</span><span class="p">))</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Cleaning up&#39;</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">deleteJobTemplate</span><span class="p">(</span><span class="n">jt</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>Again, this example is very similar to Example 2, this time with the exception
of lines 22-40. On line 38, we use jobStatus() to get the status of the job.
Line 43 determine what the job status is and report it.</p>
</div>
<div class="section" id="getting-drm-information">
<h2>Getting DRM information<a class="headerlink" href="#getting-drm-information" title="Permalink to this headline">¶</a></h2>
<p>Lastly, let&#8217;s look at how to query the DRMAA library for information about the
DRMS and the DRMAA implementation itself (example6.py):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">drmaa</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Query the system.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">drmaa</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;A DRMAA object was created&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Supported contact strings: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">s</span><span class="o">.</span><span class="n">contact</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Supported DRM systems: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">s</span><span class="o">.</span><span class="n">drmsInfo</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Supported DRMAA implementations: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">s</span><span class="o">.</span><span class="n">drmaaImplementation</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Version </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">s</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Exiting&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>On line 9, we get the contact string list. This is the list of contact strings
that will be understood by this DRMAA instance. Normally on of these strings is
used to select to which DRM this DRMAA instance should be bound. On line 10, we
get the list of supported DRM systems. On line 11, we get the list of supported
DRMAA implementations. On line 12, we get the version number of the DRMAA C
binding specification supported by this DRMAA implementation. Finally, on line
15, we end the session with exit().</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Distributed Resource Management Application API</a><ul>
<li><a class="reference internal" href="#starting-and-stopping-a-session">Starting and Stopping a Session</a></li>
<li><a class="reference internal" href="#running-a-job">Running a Job</a></li>
<li><a class="reference internal" href="#waiting-for-a-job">Waiting for a Job</a></li>
<li><a class="reference internal" href="#controlling-a-job">Controlling a Job</a></li>
<li><a class="reference internal" href="#getting-job-status">Getting Job Status</a></li>
<li><a class="reference internal" href="#getting-drm-information">Getting DRM information</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to DRMAA Python&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="drmaa.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">drmaa</span></tt> Package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorials.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="drmaa.html" title="drmaa Package"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to DRMAA Python’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">DRMAA Python 0.7.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Dan Blanchard, David Ressman, Enrico Sirola.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>